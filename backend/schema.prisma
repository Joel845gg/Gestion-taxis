generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  CLIENT
  DRIVER
  ADMIN
}

enum TripStatus {
  SOLICITADO
  ASIGNADO
  EN_CURSO
  FINALIZADO
  CANCELADO
}

model User {
  id          String   @id @default(uuid())
  email       String   @unique
  password    String
  role        UserRole @default(CLIENT)
  name        String?
  isAvailable Boolean  @default(true) // Helper for drivers
  
  tripsAsClient Trip[] @relation("ClientTrips")
  tripsAsDriver Trip[] @relation("DriverTrips")
}

model Trip {
  id          String     @id @default(uuid())
  origin      String
  destination String
  fare        Float      @default(100)
  status      TripStatus @default(SOLICITADO)
  
  clientId    String
  client      User       @relation("ClientTrips", fields: [clientId], references: [id])
  
  driverId    String?
  driver      User?      @relation("DriverTrips", fields: [driverId], references: [id])
  
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}
